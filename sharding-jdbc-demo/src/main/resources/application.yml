spring:
  sql:
    init:
      # 初始化示例表结构。
      mode: always
      schema-locations: classpath:schema.sql
  shardingsphere:
    datasource:
      # 单数据源示例。
      names: ds0
      ds0:
        type: com.zaxxer.hikari.HikariDataSource
        jdbc-url: jdbc:h2:mem:ds0;MODE=MySQL;DB_CLOSE_DELAY=-1;DATABASE_TO_LOWER=TRUE
        username: sa
        password: ""
    rules:
      sharding:
        tables:
          t_order:
            # 逻辑表映射到真实表。
            actual-data-nodes: ds0.t_order_$->{0..1}
            table-strategy:
              standard:
                # 分片键，用于表路由。
                sharding-column: order_id
                sharding-algorithm-name: order-inline
        sharding-algorithms:
          order-inline:
            type: INLINE
            props:
              # 按 order_id 取模路由。
              algorithm-expression: t_order_$->{order_id % 2}
    props:
      # 打印实际路由 SQL。
      sql-show: true

server:
  # 示例端口。
  port: 8081

# OpenAPI JOSE（JWS + JWE）示例配置：
# - 默认关闭；开启后，POST/PUT/PATCH 且 Content-Type=application/jose 的请求会先解密验签，再把解密后的 JSON 交给 Controller。
# - 响应默认也会加密（Content-Type=application/jose），仅对 2xx/3xx 生效；4xx/5xx 默认返回明文 JSON 便于排错。
#
#openapi:
#  jose:
#    enabled: true
#    server-id: sharding-demo
#    audience: openapi-gateway
#    server-kid: server-demo-202601
#    # PEM 方式（二选一：pem 或 location）
#    #server-private-key-pem: |-
#    #  -----BEGIN PRIVATE KEY-----
#    #  ...
#    #  -----END PRIVATE KEY-----
#    #server-public-key-pem: |-
#    #  -----BEGIN PUBLIC KEY-----
#    #  ...
#    #  -----END PUBLIC KEY-----
#    # 或者 location 方式（classpath:/file:/绝对路径）
#    #server-private-key-location: classpath:keys/server-private.pem
#    #server-public-key-location: classpath:keys/server-public.pem
#    response:
#      encrypt: true
#      ttl: 5m
#    clients:
#      - client-id: clientA
#        kid: clientA-key-202601
#        #public-key-pem: |-
#        #  -----BEGIN PUBLIC KEY-----
#        #  ...
#        #  -----END PUBLIC KEY-----
#        public-key-location: classpath:keys/clientA-public.pem
